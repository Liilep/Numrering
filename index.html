// För att hålla reda på numreringen och sektionerna
let currentNumber = 1; // Börjar från 1 för första sektionen
let sectionCounter = 1; // För att hålla koll på vilken sektion vi är på
let sectionLimit = 4;  // Sektionens limit (första 4 rader)
let seatStartNumber = 29; // Startnummer för nya sektioner

// Funktion som genererar den bearbetade texten
function processSeats(input) {
    const output = [];
    let currentSection = null;
    let currentRow = null;

    input.forEach(line => {
        const parts = line.split('|');
        const type = parts[1];

        if (type === 'SectionAdd') {
            currentSection = parts[2]; // Sätt aktuell sektion
            sectionCounter = 1; // Börja om på första raden för denna sektion
        } else if (type === 'RowAdd') {
            currentRow = parts[2]; // Sätt aktuell rad
            sectionCounter = 1; // Börja om på första raden för denna rad
        } else if (type === 'SeatAdd') {
            // Extrahera numret
            let seatName = parts[3].split('=')[1]; // Exempel: "Name=1"

            if (sectionCounter <= sectionLimit) {
                seatName = currentNumber; // Första sektionen och raderna
                currentNumber++;
            } else {
                seatName = seatStartNumber; // Efter sektion 1, börja numrera från 29
                seatStartNumber++;
            }

            // Uppdatera Name-fältet
            parts[3] = `Name=${seatName}`;

            // Sätt den uppdaterade raden i resultatet
            output.push(parts.join('|'));
            sectionCounter++; // Öka räknaren för sektionen/raden
        } else {
            output.push(line); // Lägg till raden utan ändringar om det inte är en SeatAdd
        }
    });

    return output.join('\n');
}

// Testinput
const input = `
20250116104139259|LayoutInit|VenueId=13168
20250116104139259|SectionAdd|SectionId=1.1|Name=Grammis
20250116104139259|RowAdd|RowId=1.1.1|Name=Bord 1
20250116104139259|SeatAdd|SeatId=1.1.1.1|Name=1|CenterX=5647.81613761482|CenterY=-3120.53807281914|Width=100|Rotation=0|EntryVia=-|Goodness=4563.60708375909
20250116104139259|SeatAdd|SeatId=1.1.1.2|Name=2|CenterX=5772.81671688895|CenterY=-3120.53807281914|Width=100|Rotation=0|EntryVia=-|Goodness=4541.12626068638
20250116104139259|SeatAdd|SeatId=1.1.1.3|Name=3|CenterX=5647.81613761482|CenterY=-3000.53807281914|Width=100|Rotation=0|EntryVia=-|Goodness=4518.64543761368
20250116104139259|SeatAdd|SeatId=1.1.1.4|Name=4|CenterX=5772.81671688895|CenterY=-3000.53807281914|Width=100|Rotation=0|EntryVia=-|Goodness=4496.16461454097
20250116104139259|SeatAdd|SeatId=1.1.1.5|Name=5|CenterX=5647.81613761482|CenterY=-2880.53807281914|Width=100|Rotation=0|EntryVia=-|Goodness=4518.64543761368
20250116104139259|SeatAdd|SeatId=1.1.1.6|Name=6|CenterX=5772.81671688895|CenterY=-2880.53807281914|Width=100|Rotation=0|EntryVia=-|Goodness=4541.12626068638
20250116104139259|SeatAdd|SeatId=1.1.1.7|Name=7|CenterX=5647.81613761482|CenterY=-2760.53807281913|Width=100|Rotation=0|EntryVia=-|Goodness=4563.60708375909
20250116104139259|SeatAdd|SeatId=1.1.1.8|Name=8|CenterX=5772.81671688895|CenterY=-2760.53807281913|Width=100|Rotation=0|EntryVia=-|Goodness=4586.08790683179
20250116104139259|RowAdd|RowId=1.1.2|Name=Bord 2
20250116104139259|SeatAdd|SeatId=1.1.2.1|Name=29|CenterX=5647.81613761482|CenterY=-2630.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4577.48413503854
20250116104139259|SeatAdd|SeatId=1.1.2.2|Name=30|CenterX=5772.81671688895|CenterY=-2630.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4555.00331196583
20250116104139259|SeatAdd|SeatId=1.1.2.3|Name=31|CenterX=5647.81613761482|CenterY=-2510.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4532.52248889313
20250116104139259|SeatAdd|SeatId=1.1.2.4|Name=32|CenterX=5772.81671688895|CenterY=-2510.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4510.04166582042
20250116104139259|SeatAdd|SeatId=1.1.2.5|Name=33|CenterX=5647.81613761482|CenterY=-2390.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4532.52248889313
20250116104139259|SeatAdd|SeatId=1.1.2.6|Name=34|CenterX=5772.81671688895|CenterY=-2390.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4555.00331196583
20250116104139259|SeatAdd|SeatId=1.1.2.7|Name=35|CenterX=5647.81613761482|CenterY=-2270.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4577.48413503854
20250116104139259|SeatAdd|SeatId=1.1.2.8|Name=36|CenterX=5772.81671688895|CenterY=-2270.35825715529|Width=100|Rotation=0|EntryVia=-|Goodness=4599.96495811124
`;

// Processera input och skriva ut resultat
console.log(processSeats(input));
